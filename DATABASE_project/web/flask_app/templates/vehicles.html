{% extends 'base.html' %}
{% block content %}
<h3>ğŸš— è½¦è¾†å½•å…¥</h3>
<form method="post">
  <label>è½¦ç‰Œ:</label>
  <input name="plate_no" required placeholder="å¦‚: A12345">
  
  <label>è½½é‡ä¸Šé™(kg):</label>
  <input name="max_weight" type="number" step="0.01" required placeholder="å¦‚: 5000">
  
  <label>å®¹ç§¯ä¸Šé™(mÂ³):</label>
  <input name="max_volume" type="number" step="0.01" required placeholder="å¦‚: 20">
  
  <label>æ‰€å±è½¦é˜Ÿ:</label>
  <select name="fleet_id" required>
    <option value="">è¯·é€‰æ‹©</option>
    {% for f in fleets %}
      <option value="{{ f.FleetId }}">{{ f.Name }}</option>
    {% endfor %}
  </select>
  
  <button type="submit">ğŸ’¾ ä¿å­˜</button>
</form>

  {% if edit_vehicle %}
  <h3>âœï¸ è½¦è¾†ä¿¡æ¯ç¼–è¾‘</h3>
  <form method="post" action="/vehicles/edit/{{ edit_vehicle.VehicleId }}">
    <label>è½¦ç‰Œ:</label>
    <input name="plate_no" required value="{{ edit_vehicle.PlateNo }}">

    <label>è½½é‡ä¸Šé™(kg):</label>
    <input name="max_weight" type="number" step="0.01" required value="{{ edit_vehicle.MaxWeight }}">

    <label>å®¹ç§¯ä¸Šé™(mÂ³):</label>
    <input name="max_volume" type="number" step="0.01" required value="{{ edit_vehicle.MaxVolume }}">

    <label>æ‰€å±è½¦é˜Ÿ:</label>
    <select name="fleet_id" required>
      {% for f in fleets %}
        <option value="{{ f.FleetId }}" {% if edit_vehicle.FleetId == f.FleetId %}selected{% endif %}>{{ f.Name }}</option>
      {% endfor %}
    </select>

    <button type="submit">ğŸ’¾ æ›´æ–°</button>
    <a href="/vehicles" style="margin-left:10px;">å–æ¶ˆ</a>
  </form>
  {% endif %}

<h3>ğŸš› è½¦è¾†åˆ—è¡¨</h3>
<form method="get" style="margin-bottom: 16px; background: white; padding: 12px; border-radius: 6px;">
  <label>æŒ‰è½¦é˜Ÿç­›é€‰:</label>
  <select name="fleet_id" onchange="this.form.submit()">
    <option value="">å…¨éƒ¨è½¦é˜Ÿ</option>
    {% for f in fleets %}
      <option value="{{ f.FleetId }}" {% if selected_fleet_id and selected_fleet_id|int == f.FleetId %}selected{% endif %}>{{ f.Name }}</option>
    {% endfor %}
  </select>
  <noscript><button type="submit">ç­›é€‰</button></noscript>
</form>
{% if vehicles %}
<table>
  <thead>
    <tr><th>ID</th><th>è½¦ç‰Œ</th><th>è½½é‡ä¸Šé™</th><th>å®¹ç§¯ä¸Šé™</th><th>çŠ¶æ€</th><th>æ‰€å±è½¦é˜Ÿ</th><th>æ“ä½œ</th></tr>
  </thead>
  <tbody>
  {% for v in vehicles %}
    <tr>
      <td>{{ v.VehicleId }}</td>
      <td><strong>{{ v.PlateNo }}</strong></td>
      <td>{{ v.MaxWeight }} kg</td>
      <td>{{ v.MaxVolume }} mÂ³</td>
      <td>{{ v.Status }}</td>
      <td>{{ v.FleetName }}</td>
      <td><a href="/vehicles/edit/{{ v.VehicleId }}">ç¼–è¾‘</a></td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% else %}
<p style="color: #999; text-align: center; padding: 20px;">æš‚æ— è½¦è¾†æ•°æ®</p>
{% endif %}
{% endblock %}
