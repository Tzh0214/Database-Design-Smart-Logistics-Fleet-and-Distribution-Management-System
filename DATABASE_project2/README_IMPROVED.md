# 智慧物流管理系统 (改进版)

## 改进内容
根据需求，本项目进行了以下改进：
1.  **角色权限管理 (RBAC)**：
    *   新增 `Users` 表用于登录认证。
    *   新增 `Managers` 表，每个车队对应一名主管。
    *   实现了登录功能，区分 **主管 (Manager)** 和 **司机 (Driver)** 角色。
    *   **主管权限**：仅能管理自己车队的车辆、司机、运单和异常。
    *   **司机权限**：仅能查看自己的相关信息。
2.  **司机绩效追踪**：
    *   新增 `sp_driver_performance_report` 存储过程。
    *   前端新增“绩效追踪”页面，支持按时间段查询运单统计和异常记录。
    *   主管可查询本车队任一司机，司机只能查询自己。
3.  **界面优化**：
    *   引入 Bootstrap 5 美化界面。
    *   根据登录角色动态显示导航菜单。

## 运行说明

### 1. 数据库初始化
请按顺序在 SQL Server 中执行以下脚本：
1.  `sql/schema.sql` (创建表结构，包含新增的 Users 和 Managers 表)
2.  `sql/views.sql` (创建视图)
3.  `sql/procedures.sql` (创建存储过程，包含新增的绩效报表)
4.  `sql/triggers.sql` (创建触发器)
5.  `sql/seed_data.sql` (插入初始数据，包含默认用户)

### 2. 启动应用
1.  进入 `web/flask_app` 目录。
2.  安装依赖：
    ```bash
    pip install -r requirements.txt
    ```
3.  配置 `.env` 文件（如果需要连接远程数据库）。
4.  运行应用：
    ```bash
    python app.py
    ```
5.  访问 `http://localhost:5000`。

### 3. 测试账号
所有默认密码均为 `123456`。

| 角色 | 用户名 | 关联身份 | 权限范围 |
| :--- | :--- | :--- | :--- |
| **主管** | `manager1` | 赵主管 (车队1) | 仅限车队1 (干线车队) |
| **主管** | `manager2` | 钱主管 (车队2) | 仅限车队2 (同城配送车队) |
| **司机** | `driver1` | 张三 (车队1) | 仅限本人 |
| **司机** | `driver2` | 李四 (车队1) | 仅限本人 |
| **司机** | `driver3` | 王五 (车队2) | 仅限本人 |

## 核心功能演示点
1.  **权限隔离**：使用 `manager1` 登录，无法看到车队2的车辆和司机。
2.  **绩效追踪**：登录后点击“绩效追踪”，选择日期范围查看统计。
3.  **触发器**：尝试分配超过车辆载重的运单，系统会报错。
